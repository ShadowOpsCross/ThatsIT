name: Deploy to S3 Bucket and Launch on EC2
on:
  push:
    branches:
      - master
jobs:
  deploy:
   runs-on: ubuntu-latest
   steps:
       - name: Checkout
         uses: actions/checkout@v2
       - name: Configure AWS credentials
         uses: aws-actions/configure-aws-credentials@v1
         with:
           aws-access-key-id: ${{ secrets.AWS_ACCESS_KEY }}
           aws-secret-access-key: ${{ secrets.AWS_SECRET_KEY }}
           aws-region:  eu-central-1 
       - name: Set up SSH key
         run: |
          mkdir -p ~/.ssh
          echo "${{ secrets.AWS_PUBLIC_KEY }}" > publik.pem
          chmod 400 publik.pem
       - name: SSH to AWS Instance
         run: |
          ssh -i publik.pem ubuntu@3.76.212.173 
